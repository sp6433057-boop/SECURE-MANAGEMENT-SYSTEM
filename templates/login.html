<!DOCTYPE html>
<html>
<head>
    <title>Login</title>

    <style>
        /* ===== GLOBAL ===== */
        body {
            margin: 0;
            height: 100vh;
            font-family: "Segoe UI", Arial, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;

            /* ü§ç Animated white background */
            background: linear-gradient(
                135deg,
                #ffffff,
                #f4f6f8,
                #ffffff,
                #eef1f4
            );
            background-size: 600% 600%;
            animation: bgMove 12s ease infinite;
        }

        @keyframes bgMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* ===== LOGIN CARD ===== */
        .login-box {
            background: #ffffff;
            padding: 35px 30px;
            width: 350px;
            border-radius: 14px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.12);
            text-align: center;
            animation: cardIn 0.6s ease;
        }

        @keyframes cardIn {
            from {
                opacity: 0;
                transform: translateY(15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Shake on error */
        .shake {
            animation: shake 0.4s;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-6px); }
            50% { transform: translateX(6px); }
            75% { transform: translateX(-6px); }
            100% { transform: translateX(0); }
        }

        h2 {
            margin-bottom: 20px;
            color: #2c2c2c;
            font-weight: 600;
        }

        /* ===== INPUTS ===== */
        input {
            width: 100%;
            padding: 11px 40px 11px 12px;
            margin-bottom: 16px;
            border-radius: 8px;
            border: 1px solid #d0d7de;
            font-size: 14px;
            box-sizing: border-box;
            transition: border 0.2s, box-shadow 0.2s;
        }

        input:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 2px rgba(76,175,80,0.15);
        }

        .password-box {
            position: relative;
        }

        .password-box span {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            font-size: 16px;
            opacity: 0.6;
        }

        .password-box span:hover {
            opacity: 1;
        }

        /* ===== BUTTON ===== */
        button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #4CAF50, #43a047);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: transform 0.1s, box-shadow 0.1s;
        }

        button:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(76,175,80,0.35);
        }

        button:disabled {
            opacity: 0.85;
            cursor: not-allowed;
        }

        /* Spinner */
        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid white;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            display: none;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== FLASH MESSAGES ===== */
        .msg {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 18px;
            font-size: 14px;
            animation: popup 0.4s ease;
        }

        .msg.error {
            background: #fdecea;
            color: #b3261e;
        }

        .msg.success {
            background: #e8f5e9;
            color: #1b5e20;
        }

        @keyframes popup {
            from {
                opacity: 0;
                transform: translateY(-10px) scale(0.96);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* ===== LINK ===== */
        a {
            color: #4CAF50;
            font-weight: 500;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }
    </style>
</head>

<body>

<div class="login-box" id="loginBox">

    <h2>Welcome Back</h2>

    <!-- FLASH MESSAGES (UNCHANGED BACKEND) -->
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for msg in messages %}
          <div class="msg">{{ msg }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <form method="POST" onsubmit="startLoading()">

        <input type="email" name="email" placeholder="Email address" required>

        <div class="password-box">
            <input type="password"
                   id="loginPassword"
                   name="password"
                   placeholder="Password"
                   required>
            <span onclick="togglePassword()">üëÅ</span>
        </div>

        <button type="submit" id="loginBtn">
            <span id="btnText">Login</span>
            <span class="spinner" id="spinner"></span>
        </button>
    </form>

    <p style="margin-top:18px;">
        Don‚Äôt have an account?
        <a href="{{ url_for('register') }}">Register</a>
    </p>

</div>

<script>
function togglePassword() {
    const pwd = document.getElementById("loginPassword");
    pwd.type = pwd.type === "password" ? "text" : "password";
}

function startLoading() {
    document.getElementById("btnText").innerText = "Logging in...";
    document.getElementById("spinner").style.display = "inline-block";
    document.getElementById("loginBtn").disabled = true;
}

/* Detect success vs error (no backend changes) */
const msg = document.querySelector(".msg");
if (msg) {
    const text = msg.innerText.toLowerCase();
    if (text.includes("success") || text.includes("welcome") || text.includes("logged")) {
        msg.classList.add("success");
    } else {
        msg.classList.add("error");
        document.getElementById("loginBox").classList.add("shake");
    }
}
</script>

</body>
</html>
